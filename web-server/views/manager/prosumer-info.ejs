<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Prosumer Info</title>
    <%- include('../partials/bootstrap-css') %>
    <link rel="stylesheet" type="text/css" href="/css/global.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.js"></script>
    
    <script type="text/javascript" src="/js/prosumer/prosumer-production-chart.js"></script>
    <script type="text/javascript" src="/js/prosumer/prosumer-production-updater.js"></script>
    <script type="text/javascript" src="/js/manager/modelled-price-chart.js"></script>
    <script type="text/javascript" src="/js/manager/modelled-price-updater.js"></script>
    <script type="text/javascript" src="/js/manager/prosumer-account-data-updater.js"></script>
    <script type="text/javascript" src="/js/climate/wind-speed-chart.js"></script>
    <script type="text/javascript" src="/js/climate/wind-speed-updater.js"></script>
  </head>

  <body onload="loadProsumerChart('manager', '<%- prosumer.id %>');
    loadProsumerDataUpdater('manager', '<%- prosumer.id %>'); loadModelledPriceChart(); loadModelledPriceData();
    loadUpdateProsumerAccountData('<%= prosumer.id %>');"
    onunload="unloadProsumerChart(); unloadProsumerDataUpdater(); unloadModelledPriceChart(); 
    unloadModelledPriceData(); unloadUpdateProsumerAccountData();">

    <%- include('./appbar', {active: 'null'}) %>
    <div class="jumbotron text-center">
        <h1>Prosumer Info</h1>
    </div>

    <div class="container text-center">
        <div class="col-md text-center">
            <h2>Account</h2>
                <p><%- include('../partials/avatar', {user: prosumer, size: 100})%></p>
                <p id="prosumerId"></p>
                <p id="prosumerName"></p>
                <p id="prosumerEmail"></p>
                <p id="prosumerRole"></p>
                <p id="prosumerCreatedAt"></p>
                <p id="prosumerUpdatedAt"></p>

            <h3>Status</h2>
                <p id="prosumerOnline"></p>
                <p id="prosumerRemoved"></p>
                <p id="prosumerBlackOut"></p>
        </div>

        <br>

        <div class="row d-flex justify-content-center">
            <div class="col-md-3 text-center">
                <div class="button-container">
                    <form action="/manager/block/prosumer" method="POST">
                        <input class="form-control" type="number" name="timeout" min="10" max="100" size="3" value="10">
                        <button class="btn octicon octicon-circle-slash" type="submit" name="prosumerId" 
                            value=<%= prosumer.id; %>>Block Prosumer</button>
                    </form>
                </div>
            </div>
            <div class="col-md-3 text-center">
                <div class="button-container">
                    <form action="/manager/remove/prosumer" method="POST">
                        <button class="btn octicon octicon-x" type="submit" name="prosumerId" 
                            value=<%= prosumer.id; %>>Remove Prosumer</button>
                    </form>
                </div>
            </div>
        </div>
        

        <hr>

        <div class="row">
            <div class="col-md-6">
                <h3>Production</h3>
                <canvas id="prosumerChart" width="150" height="100"></canvas>
                <div class="row col-md-12">
                    <div class="col-md-6">
                        <p id="prosumerConsumption"></p>
                    </div>
                    <div class="col-md-6">
                        <p id="prosumerProduction"></p>
                    </div>
                </div>
                <p id="prosumerNetConsumption"></p>
            </div>

            <div class="col-md-6">
                <h3>Buffer</h3> 
                <canvas id="batteryChart" width="150" height="100"></canvas>
                <div class="row mb-4">
                  <div class="col-sm-3" data-toggle="tooltip" data-placement="top"
                       title="The currently stored electricity in the battery.">
                    <p id="battery">Stored: <span>...</span></p>
                  </div>
                  <div class="col-sm-3" data-toggle="tooltip" data-placement="top"
                       title="The maximum capacity of this battery.">
                    <p id="batteryMax">Capacity: <span>...</span></p>
                  </div>
                  <div class="col-sm-3" data-toggle="tooltip" data-placement="top"
                       title="The ratio of excessively produced electricity
                              that will be charged to the battery in procent form 0
                              to 100.">
                    <p id="batteryExcessive">Charge Ratio: <span>...</span></p>
                  </div>
                  <div class="col-sm-3" data-toggle="tooltip" data-placement="top"
                       title="The ratio of under production electricty that
                              will be consumed from the battery in procent
                              from 0 to 100.">
                    <p id="batteryUnder">Consume Ratio: <span>...</span></p>
                  </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-6">
                <h3>Electricity Price</h3>
                <canvas id="priceChart" width="150" height="100"></canvas>
                <p id="currentPrice">Current Price: <span></span></p>
            </div>
            <div class="col-md-6">
                <h3>Wind speed</h3>
                <canvas id="windSpeedChart" width="150" height="100"></canvas>
                <p id="windSpeed">WindSpeed: <span>...</span></p>
            </div>
        </div>
    </div>
    <%- include('../partials/bootstrap-js') %>
  </body>
</html>
        
